"""
methods and data for checking results against Mochnacki's 1984 results
"""
import matplotlib.pyplot as plt
import numpy as np

import c_util as cu
import l_p_points as lp

qs = np.array(
    [0.04, 0.06, 0.08, 0.10, 0.12, 0.16, 0.20, 0.24, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1.00, 25, 50. / 3, 12.5,
     10, 25. / 3, 25. / 4, 5, 25. / 6, 10. / 3, 2.5, 2, 5. / 3, 10. / 7, 1.25, 10. / 9])
Fs = np.array([0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 1.0, 1.05, 1.1, 1.2, 1.4, 1.6, 1.8, 1.9, 1.95, 2.0])

Q, F = np.meshgrid(qs, Fs, indexing='ij')  # Mochnackis sampling on q and F

# Mochnacki's results in arrays
rs = np.array([
    [1.14899e-1, 1.72973e-1, 2.31758e-1, 2.91633e-1, 3.53158e-1, 4.17175e-1, 4.85034e-1, 5.59187e-1, 6.00107e-1,
     6.45428e-1, 6.46171e-1, 6.46917e-1, 6.48413e-1, 6.51433e-1, 6.54487e-1, 6.57579e-1, 6.59138e-1, 6.59922e-1,
     6.60708e-1],
    [1.10211e-1, 1.66070e-1, 2.22694e-1, 2.80417e-1, 3.39735e-1, 4.01386e-1, 4.66538e-1, 5.37258e-1, 5.75913e-1,
     6.18228e-1, 6.19214e-1, 6.20203e-1, 6.22192e-1, 6.26211e-1, 6.30289e-1, 6.34429e-1, 6.36522e-1, 6.37575e-1,
     6.38632e-1],
    [1.06332e-1, 1.60373e-1, 2.15235e-1, 2.71224e-1, 3.28790e-1, 3.88601e-1, 4.51708e-1, 5.19933e-1, 5.57021e-1,
     5.97353e-1, 5.98550e-1, 5.99752e-1, 6.02171e-1, 6.07069e-1, 6.12052e-1, 6.17123e-1, 6.19693e-1, 6.20987e-1,
     6.22287e-1],
    [1.02989e-1, 1.55471e-1, 2.08832e-1, 2.63356e-1, 3.19459e-1, 3.77761e-1, 4.39226e-1, 5.05517e-1, 5.41420e-1,
     5.80314e-1, 5.81701e-1, 5.83094e-1, 5.85900e-1, 5.91591e-1, 5.97393e-1, 6.03313e-1, 6.06319e-1, 6.07834e-1,
     6.09358e-1],
    [1.00035e-1, 1.51145e-1, 2.03192e-1, 2.56442e-1, 3.11285e-1, 3.68304e-1, 4.28401e-1, 4.93107e-1, 5.28094e-1,
     5.65882e-1, 5.67442e-1, 5.69010e-1, 5.72170e-1, 5.78587e-1, 5.85144e-1, 5.91849e-1, 5.95261e-1, 5.96982e-1,
     5.98714e-1],
    [9.49629e-2, 1.43728e-1, 1.93539e-1, 2.44640e-1, 2.97386e-1, 3.52305e-1, 4.10214e-1, 4.72504e-1, 5.06080e-1,
     5.42268e-1, 5.44136e-1, 5.46015e-1, 5.49805e-1, 5.57526e-1, 5.65445e-1, 5.73578e-1, 5.77732e-1, 5.79831e-1,
     5.81946e-1],
    [9.06864e-2, 1.37481e-1, 1.85425e-1, 2.34746e-1, 2.85778e-1, 3.39015e-1, 3.95219e-1, 4.55687e-1, 4.88260e-1,
     5.23331e-1, 5.25468e-1, 5.27620e-1, 5.31965e-1, 5.40837e-1, 5.49968e-1, 5.59387e-1, 5.64213e-1, 5.66657e-1,
     5.69123e-1],
    [8.69777e-2, 1.32067e-1, 1.78401e-1, 2.26199e-1, 2.75779e-1, 3.27613e-1, 3.82429e-1, 4.41464e-1, 4.73267e-1,
     5.07523e-1, 5.09901e-1, 5.12296e-1, 5.17137e-1, 5.27044e-1, 5.37276e-1, 5.47870e-1, 5.53318e-1, 5.56082e-1,
     5.58874e-1],
    [8.21917e-2, 1.25082e-1, 1.69347e-1, 2.15199e-1, 2.62945e-1, 3.13036e-1, 3.66170e-1, 4.23530e-1, 4.54474e-1,
     4.87847e-1, 4.90543e-1, 4.93261e-1, 4.98763e-1, 5.10055e-1, 5.21773e-1, 5.33978e-1, 5.40285e-1, 5.43495e-1,
     5.46744e-1],
    [7.56637e-2, 1.15552e-1, 1.57000e-1, 2.00221e-1, 2.45517e-1, 2.93329e-1, 3.44334e-1, 3.99688e-1, 4.29664e-1,
     4.62105e-1, 4.65249e-1, 4.68421e-1, 4.74856e-1, 4.88125e-1, 5.01993e-1, 5.16585e-1, 5.24189e-1, 5.28078e-1,
     5.32030e-1],
    [7.03726e-2, 1.07819e-1, 1.46977e-1, 1.88069e-1, 2.31404e-1, 2.77429e-1, 3.26824e-1, 3.80752e-1, 4.10092e-1,
     4.41983e-1, 4.45498e-1, 4.49049e-1, 4.56266e-1, 4.71209e-1, 4.86944e-1, 5.03648e-1, 5.12437e-1, 5.16958e-1,
     5.21570e-1],
    [6.59418e-2, 1.01333e-1, 1.38560e-1, 1.77861e-1, 2.19557e-1, 2.64110e-1, 3.12218e-1, 3.65069e-1, 3.93969e-1,
     4.25525e-1, 4.29357e-1, 4.33231e-1, 4.41118e-1, 4.57513e-1, 4.74897e-1, 4.93534e-1, 5.03439e-1, 5.08567e-1,
     5.13827e-1],
    [6.21476e-2, 9.57668e-2, 1.31327e-1, 1.69080e-1, 2.09366e-1, 2.52666e-1, 2.99702e-1, 3.51704e-1, 3.80288e-1,
     4.11647e-1, 4.15753e-1, 4.19908e-1, 4.28379e-1, 4.46053e-1, 4.64923e-1, 4.85361e-1, 4.96348e-1, 5.02082e-1,
     5.08003e-1],
    [5.88447e-2, 9.09111e-2, 1.25005e-1, 1.61396e-1, 2.00442e-1, 2.42648e-1, 2.88768e-1, 3.40078e-1, 3.68430e-1,
     3.99681e-1, 4.04027e-1, 4.08429e-1, 4.17415e-1, 4.36231e-1, 4.56458e-1, 4.78609e-1, 4.90675e-1, 4.97037e-1,
     5.03671e-1],
    [5.59326e-2, 8.66205e-2, 1.19408e-1, 1.54581e-1, 1.92521e-1, 2.33755e-1, 2.79073e-1, 3.29804e-1, 3.57982e-1,
     3.89188e-1, 3.93747e-1, 3.98368e-1, 4.07813e-1, 4.27659e-1, 4.49140e-1, 4.72946e-1, 4.86125e-1, 4.93178e-1,
     5.00656e-1],
    [5.33387e-2, 8.27900e-2, 1.14400e-1, 1.48474e-1, 1.85413e-1, 2.25772e-1, 2.70375e-1, 3.20611e-1, 3.48659e-1,
     3.79863e-1, 3.84612e-1, 3.89429e-1, 3.99287e-1, 4.20070e-1, 4.42721e-1, 4.68156e-1, 4.82540e-1, 4.90430e-1,
     4.99241e-1],
    [5.50370e-3, 9.19199e-3, 1.38242e-2, 1.98163e-2, 2.78713e-2, 3.92812e-2, 5.67172e-2, 8.68426e-2, 1.12330e-1,
     1.56025e-1, 1.57085e-1, 1.58152e-1, 1.60310e-1, 1.64729e-1, 1.69325e-1, 1.74172e-1, 1.76738e-1, 1.78079e-1,
     1.79492e-1],
    [7.82492e-3, 1.29835e-2, 1.93678e-2, 2.74745e-2, 3.81123e-2, 5.26960e-2, 7.39640e-2, 1.08134e-1, 1.34832e-1,
     1.76453e-1, 1.77788e-1, 1.79133e-1, 1.81854e-1, 1.87440e-1, 1.93272e-1, 1.99455e-1, 2.02749e-1, 2.04478e-1,
     2.06311e-1],
    [9.96440e-3, 1.64452e-2, 2.43708e-2, 3.42870e-2, 4.70562e-2, 6.41324e-2, 8.81981e-2, 1.24967e-1, 1.52229e-1,
     1.92304e-1, 1.93870e-1, 1.95447e-1, 1.98642e-1, 2.05213e-1, 2.12094e-1, 2.19421e-1, 2.23343e-1, 2.25409e-1,
     2.27609e-1],
    [1.19565e-2, 1.96432e-2, 2.89497e-2, 4.04506e-2, 5.50331e-2, 7.41496e-2, 1.00382e-1, 1.38980e-1, 1.66529e-1,
     2.05401e-1, 2.07167e-1, 2.08948e-1, 2.12556e-1, 2.19989e-1, 2.27793e-1, 2.36134e-1, 2.40616e-1, 2.42985e-1,
     2.45517e-1],
    [1.38246e-2, 2.26222e-2, 3.31812e-2, 4.60926e-2, 6.22509e-2, 8.30854e-2, 1.11063e-1, 1.51025e-1, 1.78725e-1,
     2.16631e-1, 2.18576e-1, 2.20538e-1, 2.24515e-1, 2.32719e-1, 2.41353e-1, 2.50611e-1, 2.55603e-1, 2.58248e-1,
     2.61084e-1],
    [1.72529e-2, 2.80441e-2, 4.08080e-2, 5.61458e-2, 7.49382e-2, 9.85406e-2, 1.29192e-1, 1.71072e-1, 1.98885e-1,
     2.35325e-1, 2.37580e-1, 2.39856e-1, 2.44473e-1, 2.54021e-1, 2.64109e-1, 2.74984e-1, 2.80883e-1, 2.84022e-1,
     2.87406e-1],
    [2.03456e-2, 3.28900e-2, 4.75521e-2, 6.49260e-2, 8.58610e-2, 1.11628e-1, 1.44265e-1, 1.87444e-1, 2.15266e-1,
     2.50645e-1, 2.53163e-1, 2.55705e-1, 2.60868e-1, 2.71566e-1, 2.82905e-1, 2.95185e-1, 3.01878e-1, 3.05453e-1,
     3.09323e-1],
    [2.31658e-2, 3.72754e-2, 5.36030e-2, 7.27273e-2, 9.54597e-2, 1.22990e-1, 1.57180e-1, 2.01314e-1, 2.29110e-1,
     2.63686e-1, 2.66433e-1, 2.69207e-1, 2.74846e-1, 2.86550e-1, 2.98992e-1, 3.12518e-1, 3.19920e-1, 3.23887e-1,
     3.28196e-1],
    [2.69801e-2, 4.31610e-2, 6.16542e-2, 8.30089e-2, 1.07978e-1, 1.37641e-1, 1.73647e-1, 2.18840e-1, 2.46587e-1,
     2.80270e-1, 2.83313e-1, 2.86388e-1, 2.92643e-1, 3.05656e-1, 3.19540e-1, 3.34708e-1, 3.43052e-1, 3.47540e-1,
     3.52439e-1],
    [3.24713e-2, 5.15525e-2, 7.30132e-2, 9.73501e-2, 1.25228e-1, 1.57579e-1, 1.95793e-1, 2.42223e-1, 2.69910e-1,
     3.02619e-1, 3.06063e-1, 3.09546e-1, 3.16642e-1, 3.31447e-1, 3.47323e-1, 3.64783e-1, 3.74453e-1, 3.79681e-1,
     3.85421e-1],
    [3.71419e-2, 5.86244e-2, 8.24919e-2, 1.09194e-1, 1.39323e-1, 1.73701e-1, 2.13539e-1, 2.60873e-1, 2.88547e-1,
     3.20651e-1, 3.24417e-1, 3.28228e-1, 3.36000e-1, 3.52256e-1, 3.69758e-1, 3.89106e-1, 3.99879e-1, 4.05726e-1,
     4.12173e-1],
    [4.11910e-2, 6.47128e-2, 9.05939e-2, 1.19243e-1, 1.51196e-1, 1.87191e-1, 2.28312e-1, 2.76375e-1, 3.04077e-1,
     3.35796e-1, 3.39827e-1, 3.43908e-1, 3.52239e-1, 3.69702e-1, 3.88564e-1, 4.09505e-1, 4.21215e-1, 4.27589e-1,
     4.34644e-1],
    [4.47520e-2, 7.00389e-2, 9.76430e-2, 1.27939e-1, 1.61419e-1, 1.98754e-1, 2.40937e-1, 2.89627e-1, 3.17387e-1,
     3.48862e-1, 3.53115e-1, 3.57424e-1, 3.66227e-1, 3.84710e-1, 4.04730e-1, 4.27036e-1, 4.39553e-1, 4.46384e-1,
     4.53966e-1],
    [4.79197e-2, 7.47569e-2, 1.03861e-1, 1.35579e-1, 1.70366e-1, 2.08845e-1, 2.51938e-1, 3.01187e-1, 3.29028e-1,
     3.60353e-1, 3.64796e-1, 3.69299e-1, 3.78505e-1, 3.97864e-1, 4.18883e-1, 4.42372e-1, 4.55592e-1, 4.62821e-1,
     4.70864e-1],
    [5.07642e-2, 7.89791e-2, 1.09407e-1, 1.42373e-1, 1.78301e-1, 2.17777e-1, 2.61667e-1, 3.11428e-1, 3.39366e-1,
     3.70607e-1, 3.75214e-1, 3.79884e-1, 3.89438e-1, 4.09558e-1, 4.31446e-1, 4.55970e-1, 4.69807e-1, 4.77387e-1,
     4.85837e-1]])

areas = np.array([
    [1.65899e-1, 3.75981e-1, 9.42868e-2, 1.06881, 1.56746, 2.18766, 2.95870, 4.29168, 4.73096, 5.27157, 5.28377,
     5.29559, 5.31891, 5.36512, 5.41130, 5.45772, 5.48106, 5.49277, 5.50450],
    [1.52636e-1, 3.46571e-1, 8.61322e-2, 9.88169e-1, 1.45054, 2.02512, 2.73709, 3.96954, 4.36198, 4.83330, 4.84863,
     4.86344, 4.89265, 4.95063, 5.00879, 5.06749, 5.09711, 5.11200, 5.12695],
    [1.42081e-1, 3.23199e-1, 6.74967e-1, 9.24438e-1, 1.35857, 1.89812, 2.56568, 3.72754, 4.08598, 4.51094, 4.52879,
     4.54601, 4.57997, 4.64751, 4.71550, 4.78441, 4.81931, 4.83688, 4.85454],
    [1.33287e-1, 3.03744e-1, 6.23201e-1, 8.71582e-1, 1.28255, 1.79367, 2.42574, 3.53391, 3.86576, 4.25660, 4.27657,
     4.29580, 4.33375, 4.40938, 4.48577, 4.56354, 4.60306, 4.62300, 4.64306],
    [1.25751e-1, 2.87076e-1, 5.82154e-1, 8.26413e-1, 1.21776, 1.70497, 2.30758, 3.37209, 3.68301, 4.04722, 4.06901,
     4.08998, 4.13137, 4.21402, 4.29781, 4.38345, 4.42713, 4.44920, 4.47143],
    [1.13323e-1, 2.59592e-1, 5.48035e-1, 7.52098e-1, 1.11143, 1.56003, 2.11573, 2.80950, 3.39179, 3.71642, 3.74123,
     3.76506, 3.81215, 3.90658, 4.00297, 4.10231, 4.15331, 4.17917, 4.20529],
    [1.03346e-1, 2.37517e-1, 5.18830e-1, 6.92494e-1, 1.02635, 1.44453, 1.96383, 2.61296, 3.16568, 3.46161, 3.48883,
     3.51495, 3.56664, 3.67070, 3.77767, 3.88878, 3.94619, 3.97541, 4.00499],
    [9.50661e-2, 2.19178e-1, 4.70707e-1, 6.42981e-1, 9.55782e-1, 1.34899, 1.83875, 2.45232, 2.82124, 3.25596, 3.28517,
     3.31318, 3.36868, 3.48090, 3.59701, 3.71855, 3.78176, 3.81404, 3.84680],
    [8.48918e-2, 1.96608e-1, 4.32064e-1, 5.81968e-1, 8.68891e-1, 1.23161, 1.68570, 2.25709, 2.60163, 3.00891, 3.04054,
     3.07085, 3.13103, 3.25345, 3.38135, 3.51677, 3.58787, 3.62437, 3.66155],
    [7.19424e-2, 1.67791e-1, 3.99951e-1, 5.03774e-1, 7.57522e-1, 1.08140, 1.49062, 2.01010, 2.32539, 2.70054, 2.73516,
     2.76833, 2.83444, 2.97021, 3.11430, 3.26968, 3.35258, 3.39552, 3.43954],
    [6.22324e-2, 1.46084e-1, 3.60386e-1, 4.44479e-1, 6.72936e-1, 9.67339e-1, 1.34286, 1.82415, 2.11845, 2.47115,
     2.50792, 2.54317, 2.61365, 2.75978, 2.91718, 3.09003, 3.18376, 3.23279, 3.28341],
    [5.46426e-2, 1.29035e-1, 3.09751e-1, 3.97536e-1, 6.05795e-1, 8.76683e-1, 1.22550, 1.67696, 1.95520, 2.29112,
     2.32949, 2.36629, 2.44014, 2.59462, 2.76340, 2.95219, 3.05635, 3.11143, 3.16878],
    [4.85354e-2, 1.15250e-1, 2.71464e-1, 3.59252e-1, 5.50862e-1, 8.02348e-1, 1.12920, 1.55643, 1.82182, 2.14460,
     2.18418, 2.22217, 2.29868, 2.46006, 2.63888, 2.84266, 2.95727, 3.01865, 3.08328],
    [4.35135e-2, 1.03859e-1, 2.41262e-1, 3.27339e-1, 5.04901e-1, 7.39984e-1, 1.04830, 1.45522, 1.71001, 2.02215,
     2.06265, 2.10158, 2.18021, 2.34744, 2.53529, 2.75358, 2.87905, 2.94738, 3.02047],
    [3.93133e-2, 3.75981e-1, 2.16730e-1, 3.00280e-1, 4.65781e-1, 6.86733e-1, 9.79082e-1, 1.36862, 1.61443, 1.91773,
     1.95895, 1.99860, 2.07896, 2.25121, 2.44735, 2.68003, 2.81737, 2.89397, 2.97827],
    [3.57516e-2, 8.61322e-2, 1.64462e-1, 2.77023e-1, 4.32022e-1, 6.40622e-1, 9.18995e-1, 1.29338, 1.53145, 1.82726,
     1.86902, 1.90925, 1.99102, 2.16765, 2.37151, 2.61887, 2.77002, 2.85803, 2.96664],
    [3.80645e-4, 1.06177e-3, 2.40154e-3, 4.93461e-3, 9.76167e-3, 1.93901e-2, 4.04244e-2, 9.47867e-2, 1.58698e-1,
     3.09951e-1, 3.13854e-1, 3.17510e-1, 3.24754e-1, 3.39665e-1, 3.55712e-1, 3.73574e-1, 3.83617e-1, 3.89142e-1,
     3.95540e-1],
    [7.69434e-4, 2.11832e-3, 4.7137e7 - 3, 9.48567e-3, 1.82532e-2, 3.48953e-2, 6.87483e-2, 1.46980e-1, 2.28724e-1,
     3.96190e-1, 4.01718e-1, 4.06907e-1, 4.17218e-1, 4.38566e-1, 4.61719e-1, 4.87725e-1, 5.02478e-1, 5.10641e-1,
     5.20165e-1],
    [1.24771e-3, 3.39849e-3, 7.46364e-3, 1.47730e-2, 2.78256e-2, 5.16854e-2, 9.77570e-2, 1.96324e-1, 2.91628e-1,
     4.70356e-1, 4.77396e-1, 4.84017e-1, 4.97203e-1, 5.24617e-1, 5.54521e-1, 5.88348e-1, 6.07665e-1, 6.18404e-1,
     6.31003e-1],
    [1.79646e-3, 4.84882e-3, 1.05317e-2, 2.05617e-2, 3.80591e-2, 6.90927e-2, 1.26634e-1, 2.42842e-1, 3.49057e-1,
     5.36413e-1, 5.44876e-1, 5.52849e-1, 5.68754e-1, 6.01932e-1, 6.38295e-1, 6.79664e-1, 7.03418e-1, 7.16675e-1,
     7.32299e-1],
    [2.40167e-3, 6.43102e-3, 1.38354e-2, 2.66976e-2, 4.86970e-2, 8.67492e-2, 1.55020e-1, 2.86786e-1, 4.02119e-1,
     5.96492e-1, 6.06305e-1, 6.15560e-1, 6.34055e-1, 6.72740e-1, 7.15309e-1, 7.63973e-1, 7.92048e-1, 8.07767e-1,
     8.26366e-1],
    [3.74053e-3, 9.88310e-3, 2.09267e-2, 3.96136e-2, 7.05696e-2, 1.22025e-1, 2.09766e-1, 3.68022e-1, 4.98060e-1,
     7.03543e-1, 7.15869e-1, 7.27524e-1, 7.50868e-1, 7.99916e-1, 8.54242e-1, 9.16846e-1, 9.53242e-1, 9.73730e-1,
     9.98124e-1],
    [5.20177e-3, 1.35937e-2, 2.84151e-2, 5.29722e-2, 9.26413e-2, 1.56593e-1, 2.61574e-1, 4.41881e-1, 5.83571e-1,
     7.97819e-1, 8.12456e-1, 8.26324e-1, 8.54153e-1, 9.12832e-1, 9.78166e-1, 1.05394, 1.09827, 1.12333, 1.15332],
    [6.74379e-3, 1.74604e-2, 3.61067e-2, 6.64669e-2, 1.14513e-1, 1.90092e-1, 3.10514e-1, 5.09737e-1, 6.61119e-1,
     8.82714e-1, 8.99495e-1, 9.15422e-1, 9.47431e-1, 1.01512, 1.09032, 1.17909, 1.23100, 1.26045, 1.29584],
    [9.14740e-3, 2.34095e-2, 4.77679e-2, 8.65885e-2, 1.46516e-1, 2.38081e-1, 3.78998e-1, 6.02414e-1, 7.65906e-1,
     9.96846e-1, 1.01658, 1.03536, 1.07315, 1.15338, 1.24358, 1.34947, 1.41214, 1.44786, 1.49098],
    [1.32498e-2, 3.33971e-2, 6.69905e-2, 1.19092e-1, 1.97071e-1, 3.12058e-1, 4.81860e-1, 7.38107e-1, 9.17738e-1,
     1.16156, 1.18566, 1.20865, 1.25506, 1.35401, 1.46604, 1.59869, 1.67786, 1.72324, 1.77836],
    [1.73356e-2, 4.31883e-2, 8.55132e-2, 1.49833e-1, 2.43931e-1, 3.79183e-1, 5.73187e-1, 8.56196e-1, 1.04890, 1.30359,
     1.33150, 1.35819, 1.41217, 1.52766, 1.65910, 1.81576, 1.90965, 1.96401, 2.03009],
    [2.13213e-2, 5.26248e-2, 1.03136e-1, 1.78681e-1, 2.87279e-1, 4.40372e-1, 6.55255e-1, 9.61020e-1, 1.16486, 1.42917,
     1.46046, 1.49044, 1.55115, 1.68142, 1.83027, 2.00861, 2.11625, 2.17841, 2.25452],
    [2.51671e-2, 6.16436e-2, 1.19810e-1, 2.05694e-1, 3.27438e-1, 4.96462e-1, 7.29742e-1, 1.05542, 1.26908, 1.54213,
     1.57644, 1.60937, 1.67613, 1.81969, 1.98427, 2.18228, 2.30227, 2.37175, 2.45704],
    [2.88561e-2, 7.02283e-2, 1.35555e-1, 2.30994e-1, 3.64746e-1, 5.48161e-1, 7.97915e-1, 1.14138, 1.36388, 1.64500,
     1.68204, 1.71763, 1.78987, 1.94547, 2.12435, 2.34028, 2.47156, 2.54775, 2.64147],
    [3.23836e-2, 7.83852e-2, 1.50419e-1, 2.54724e-1, 3.99515e-1, 5.96053e-1, 8.60745e-1, 1.22033, 1.45092, 1.73960,
     1.77911, 1.81713, 1.89434, 2.06093, 2.25284, 2.48516, 2.62679, 2.70914, 2.81061], ])

gs = np.array([
    [1.45514e+2, 6.40441e+1, 3.54944e+1, 2.22215e+1, 1.49465e+1, 1.04905e+1, 7.52161, 5.17042, 4.41915, 3.72965,
     3.71809, 3.70682, 3.68460, 3.64076, 3.59734, 3.55414, 3.53260, 3.52183, 3.51107],
    [1.55191e+2, 6.81920e+1, 3.77488e+1, 2.36201e+1, 1.58927e+1, 1.11730e+1, 8.04093, 5.56027, 4.78517, 4.08645,
     4.06961, 4.05328, 4.02113, 3.95785, 3.89529, 3.83312, 3.80212, 3.78664, 3.77116],
    [1.63646e+2, 7.17884e+1, 3.96871e+1, 2.48116e+1, 1.66907e+1, 1.17420e+1, 8.46824, 5.87071, 5.07604, 4.36708,
     4.34510, 4.32385, 4.28210, 4.20009, 4.11912, 4.03873, 3.99866, 3.97865, 3.95865],
    [1.71282e+2, 7.50137e+1, 4.14122e+1, 2.58632e+1, 1.73885e+1, 1.22345e+1, 8.83368, 6.12862, 5.31746, 4.59839,
     4.57140, 4.54537, 4.49431, 4.39418, 4.29546, 4.19750, 4.14870, 4.12433, 4.09997],
    [1.78314e+2, 7.79656e+1, 4.29801e+1, 2.68115e+1, 1.80123e+1, 1.26705e+1, 9.15356, 6.34971, 5.52309, 4.79435,
     4.76246, 4.73178, 4.67168, 4.55401, 4.43812, 4.32320, 4.26597, 4.23738, 4.20882],
    [1.91063e+2, 8.32708e+1, 4.57709e+1, 2.84815e+1, 1.90975e+1, 1.34186e+1, 9.69385, 7.08263, 5.85739, 5.11095,
     5.06963, 5.03003, 4.95263, 4.80148, 4.65291, 4.50573, 4.43245, 4.39586, 4.35929],
    [2.02537e+2, 8.79955e+1, 4.82269e+1, 2.99313e+1, 2.00252e+1, 1.40468e+1, 1.01381e+1, 7.40866, 6.11854, 5.35661,
     5.30632, 5.25827, 5.16456, 4.98193, 4.80270, 4.62530, 4.53698, 4.49289, 4.44881],
    [2.13087e+2, 9.22981e+1, 5.04392e+1, 3.12208e+1, 2.08383e+1, 1.45880e+1, 1.05132e+1, 7.67712, 6.55465, 5.55227,
     5.49346, 5.43742, 5.32831, 5.11606, 4.90804, 4.70226, 4.59933, 4.54868, 4.49754],
    [2.27626e+2, 9.81653e+1, 5.34191e+1, 3.29329e+1, 2.18995e+1, 1.52799e+1, 1.09808e+1, 8.00145, 6.82651, 5.77867,
     5.70786, 5.64064, 5.51002, 5.25654, 5.00852, 4.76331, 4.64123, 4.58024, 4.51925],
    [2.49431e+2, 1.06836e+2, 5.77467e+1, 3.53680e+1, 2.33709e+1, 1.62095e+1, 1.15844e+1, 8.39864, 7.14844, 6.03531,
     5.94645, 5.86250, 5.69984, 5.38518, 5.07792, 4.77422, 4.62284, 4.54713, 4.47135],
    [2.69141e+2, 1.14551e+2, 6.15255e+1, 3.74455e+1, 2.45901e+1, 1.69510e+1, 1.20417e+1, 8.67819, 7.36370, 6.19489,
     6.09015, 5.99155, 5.80096, 5.43316, 5.07451, 4.71975, 4.54254, 4.45373, 4.36468],
    [2.87379e+2, 1.21599e+2, 6.49228e+1, 3.92762e+1, 2.56368e+1, 1.75654e+1, 1.24015e+1, 8.88078, 7.50992, 6.29253,
     6.17375, 6.06228, 5.84721, 5.43300, 5.02941, 4.62953, 4.42905, 4.32826, 4.22691],
    [3.04519e+2, 1.28150e+2, 6.80387e+1, 4.09266e+1, 2.65587e+1, 1.80890e+1, 1.26929e+1, 9.03032, 7.60913, 6.34859,
     6.21736, 6.09452, 5.85790, 5.40292, 4.95970, 4.51938, 4.29742, 4.18528, 4.07195],
    [3.20802e+2, 1.34317e+2, 7.09386e+1, 4.24398e+1, 2.73869e+1, 1.85453e+1, 1.29344e+1, 9.14199, 7.67520, 6.37581,
     6.23349, 6.10057, 5.84489, 5.35388, 4.87546, 4.39830, 4.15583, 4.03234, 3.90644],
    [3.36396e+2, 1.40177e+2, 7.36672e+1, 4.38453e+1, 2.81424e+1, 1.89502e+1, 1.31384e+1, 9.22589, 7.71733, 6.38256,
     6.23033, 6.08845, 5.81582, 5.29283, 4.78287, 4.27149, 4.00852, 3.87269, 3.73156],
    [3.51420e+2, 1.45786e+2, 7.62566e+1, 4.51643e+1, 2.88401e+1, 1.93149e+1, 1.33137e+1, 9.28901, 7.74182, 6.37456,
     6.21346, 6.06354, 5.77581, 5.22426, 4.68582, 4.14193, 3.85695, 3.70533, 3.53312],
    [2.53949e+3, 9.10400e+2, 4.02491e+2, 1.95864e+2, 9.89873e+1, 4.98002e+1, 2.38367e+1, 1.00823e+1, 5.94144, 2.91338,
     2.87305, 2.83593, 2.76482, 2.62855, 2.49567, 2.36224, 2.29310, 2.25674, 2.21620],
    [1.84890e+3, 6.71556e+2, 3.01772e+2, 1.49938e+2, 7.78865e+1, 4.06976e+1, 2.05944e+1, 9.53479, 6.04020, 3.35838,
     3.30700, 3.25974, 3.16931, 2.99630, 2.82797, 2.65917, 2.57166, 2.52558, 2.47403],
    [1.49207e+3, 5.47776e+2, 2.49401e+2, 1.25973e+2, 6.68428e+1, 3.59340e+1, 1.89264e+1, 9.31615, 6.18108, 3.70470,
     3.64401, 3.58820, 3.48146, 3.27750, 3.07936, 2.88081, 2.77782, 2.72354, 2.66265],
    [1.27181e+3, 4.71180e+2, 2.16906e+2, 1.11065e+2, 5.99593e+1, 3.29697e+1, 1.79087e+1, 9.22334, 6.32395, 3.98871,
     3.91992, 3.85666, 3.73572, 3.50484, 3.28077, 3.05631, 2.93985, 2.87839, 2.80934],
    [1.12120e+3, 4.18688e+2, 1.94586e+2, 1.00801e+2, 5.52139e+1, 3.09304e+1, 1.72226e+1, 9.18831, 6.45862, 4.22882,
     4.15285, 4.08298, 3.94944, 3.69468, 3.44760, 3.20015, 3.07170, 3.00387, 2.92752],
    [9.26739e+2, 3.50721e+2, 1.65599e+2, 8.74351e+1, 4.90230e+1, 2.82774e+1, 1.63537e+1, 9.19157, 6.69553, 4.61697,
     4.52874, 4.44755, 4.29244, 3.99679, 3.71027, 3.42336, 3.27429, 3.19548, 3.10656],
    [8.05237e+2, 3.08099e+2, 1.47351e+2, 7.89887e+1, 4.51007e+1, 2.66007e+1, 1.58214e+1, 9.22973, 6.89145, 4.91961,
     4.82122, 4.73064, 4.55759, 4.22791, 3.90852, 3.58862, 3.42229, 3.33427, 3.23480],
    [7.21285e+2, 2.78547e+2, 1.34651e+2, 7.30883e+1, 4.23519e+1, 2.54257e+1, 1.54561e+1, 9.27478, 7.05304, 5.16273,
     5.05575, 4.95721, 4.76897, 4.41039, 4.06303, 3.71501, 3.53394, 3.43804, 3.32952],
    [6.34008e+2, 2.47699e+2, 1.21335e+2, 6.68712e+1, 3.94411e+1, 2.41773e+1, 1.50716e+1, 9.33620, 7.24455, 5.44817,
     5.33057, 5.22216, 5.01502, 4.62042, 4.23809, 3.85480, 3.65519, 3.54939, 3.42950],
    [5.41910e+2, 2.14943e+2, 1.07094e+2, 6.01661e+1, 3.62706e+1, 2.28010e+1, 1.46412e+1, 9.40604, 7.46544, 5.78228,
     5.65132, 5.53042, 5.29929, 4.85879, 4.43164, 4.00293, 3.77938, 3.66077, 3.52619],
    [4.83209e+2, 1.93900e+2, 9.78583e+1, 5.57672e+1, 3.41583e+1, 2.18622e+1, 1.43311e+1, 9.43723, 7.60328, 6.00281,
     5.86227, 5.73231, 5.48375, 5.00962, 4.54938, 4.08693, 3.84554, 3.71736, 3.57183],
    [4.41981e+2, 1.79008e+2, 9.12617e+1, 5.25874e+1, 3.26055e+1, 2.11523e+1, 1.40791e+1, 9.43900, 7.68647, 6.15067,
     6.00313, 5.86651, 5.60503, 5.10579, 4.62063, 4.13258, 3.87759, 3.74212, 3.58826],
    [4.11142e+2, 1.67787e+2, 8.62465e+1, 5.01410e+1, 3.13900e+1, 2.05801e+1, 1.38603e+1, 9.41965, 7.73242, 6.24940,
     6.09673, 5.95517, 5.68403, 5.16585, 4.66168, 4.15397, 3.88849, 3.74739, 3.58711],
    [3.87032e+2, 1.58955e+2, 8.22642e+1, 4.81759e+1, 3.03972e+1, 2.00990e+1, 1.36633e+1, 9.38542, 7.75235, 6.31371,
     6.15726, 6.01203, 5.73366, 5.20113, 4.68240, 4.15946, 3.88583, 3.74033, 3.57506],
    [3.67556e+2, 1.51773e+2, 7.89993e+1, 4.65470e+1, 2.95609e+1, 1.96827e+1, 1.34823e+1, 9.34080, 7.75375, 6.35323,
     6.19406, 6.04611, 5.76235, 5.21896, 4.68905, 4.15431, 3.87430, 3.72537, 3.55620], ])

gminus1s = np.array([
    [6.87219e-3, 1.56144e-2, 2.81754e-2, 4.50139e-2, 6.69661e-2, 9.55738e-2, 1.33889e-1, 2.16357e-1, 2.48058e-1,
     2.89403e-1, 2.90210e-1, 2.91047e-1, 2.92766e-1, 2.96342e-1, 3.00080e-1, 3.03977e-1, 3.05985e-1, 3.07004e-1,
     3.08034e-1],
    [6.44369e-3, 1.46646e-2, 2.64925e-2, 4.23471e-2, 6.29717e-2, 8.97050e-2, 1.25122e-1, 2.02168e-1, 2.29418e-1,
     2.62075e-1, 2.62986e-1, 2.63937e-1, 2.65903e-1, 2.70029e-1, 2.74385e-1, 2.78969e-1, 2.81349e-1, 2.82561e-1,
     2.83789e-1],
    [6.11076e-3, 1.39300e-2, 2.51985e-2, 4.03126e-2, 5.99566e-2, 8.53390e-2, 1.18738e-1, 1.92476e-1, 2.16923e-1,
     2.44406e-1, 2.45399e-1, 2.46445e-1, 2.48616e-1, 2.53205e-1, 2.58093e-1, 2.63280e-1, 2.65991e-1, 2.67377e-1,
     2.68783e-1],
    [5.83834e-3, 1.33310e-2, 2.41486e-2, 3.86727e-2, 5.75474e-2, 8.18912e-2, 1.13781e-1, 1.85325e-1, 2.07809e-1,
     2.31773e-1, 2.32839e-1, 2.33966e-1, 2.36318e-1, 2.41320e-1, 2.46691e-1, 2.52435e-1, 2.55455e-1, 2.57003e-1,
     2.58578e-1],
    [5.60808e-3, 1.28263e-2, 2.32676e-2, 3.73044e-2, 5.55521e-2, 7.90646e-2, 1.09773e-1, 1.79820e-1, 2.00818e-1,
     2.22194e-1, 2.23325e-1, 2.24526e-1, 2.27042e-1, 2.32425e-1, 2.38246e-1, 2.44519e-1, 2.47835e-1, 2.49541e-1,
     2.51279e-1],
    [5.23388e-3, 1.20091e-2, 2.18488e-2, 3.51165e-2, 5.23923e-2, 7.46452e-2, 1.03617e-1, 1.42911e-1, 1.90769e-1,
     2.08532e-1, 2.09776e-1, 2.11110e-1, 2.13922e-1, 2.20004e-1, 2.26668e-1, 2.33948e-1, 2.37840e-1, 2.39853e-1,
     2.41913e-1],
    [4.93736e-3, 1.13643e-2, 2.07361e-2, 3.34151e-2, 4.99633e-2, 7.13000e-2, 9.90529e-2, 1.36557e-1, 1.83928e-1,
     1.99236e-1, 2.00582e-1, 2.02036e-1, 2.05117e-1, 2.11845e-1, 2.19306e-1, 2.27562e-1, 2.32023e-1, 2.34344e-1,
     2.36729e-1],
    [4.69293e-3, 1.08345e-2, 1.98265e-2, 3.20346e-2, 4.80123e-2, 6.86499e-2, 9.55045e-2, 1.31745e-1, 1.55720e-1,
     1.92539e-1, 1.93978e-1, 1.95543e-1, 1.98876e-1, 2.06216e-1, 2.14449e-1, 2.23674e-1, 2.28711e-1, 2.31347e-1,
     2.34067e-1],
    [4.39318e-3, 1.01869e-2, 1.87205e-2, 3.03689e-2, 4.56843e-2, 6.55365e-2, 9.14240e-2, 1.26376e-1, 1.49500e-1,
     1.85500e-1, 1.87069e-1, 1.88789e-1, 1.92477e-1, 2.00698e-1, 2.10066e-1, 2.20760e-1, 2.26692e-1, 2.29825e-1,
     2.33079e-1],
    [4.00912e-3, 9.36018e-3, 1.73175e-2, 2.82776e-2, 4.28064e-2, 6.17725e-2, 8.66468e-2, 1.20382e-1, 1.42786e-1,
     1.78410e-1, 1.80178e-1, 1.82139e-1, 1.86384e-1, 1.96013e-1, 2.07268e-1, 2.20516e-1, 2.28075e-1, 2.32134e-1,
     2.36404e-1],
    [3.71552e-3, 8.72974e-3, 1.62538e-2, 2.67085e-2, 4.06829e-2, 5.90665e-2, 8.33472e-2, 1.16498e-1, 1.38648e-1,
     1.74536e-1, 1.76491e-1, 1.78678e-1, 1.83452e-1, 1.94456e-1, 2.07635e-1, 2.23654e-1, 2.33087e-1, 2.36257e-1,
     2.43782e-1],
    [3.47972e-3, 8.22380e-3, 1.54033e-2, 2.54633e-2, 3.90209e-2, 5.69975e-2, 8.09212e-2, 1.13838e-1, 1.35985e-1,
     1.72477e-1, 1.74609e-1, 1.77013e-1, 1.82300e-1, 1.94668e-1, 2.09842e-1, 2.28935e-1, 2.40605e-1, 2.47167e-1,
     2.54334e-1],
    [3.28387e-3, 7.80339e-3, 1.46978e-2, 2.44363e-2, 3.76655e-2, 5.53447e-2, 7.90567e-2, 1.11950e-1, 1.34244e-1,
     1.71541e-1, 1.73844e-1, 1.76458e-1, 1.82246e-1, 1.95980e-1, 2.13245e-1, 2.35817e-1, 2.50256e-1, 2.58664e-1,
     2.68150e-1],
    [3.11719e-3, 7.44509e-3, 1.40970e-2, 2.35648e-2, 3.65257e-2, 5.39804e-2, 7.75743e-2, 1.10579e-1, 1.33116e-1,
     1.71342e-1, 1.73812e-1, 1.76631e-1, 1.82913e-1, 1.98023e-1, 2.17496e-1, 2.44088e-1, 2.62121e-1, 2.73178e-1,
     2.86353e-1],
    [2.97269e-3, 7.13384e-3, 1.35748e-2, 2.28093e-2, 3.55445e-2, 5.28247e-2, 7.63636e-2, 1.09568e-1, 1.32411e-1,
     1.71651e-1, 1.74284e-1, 1.77304e-1, 1.84073e-1, 2.00574e-1, 2.22396e-1, 2.53746e-1, 2.76768e-1, 2.92146e-1,
     3.12745e-1],
    [2.84560e-3, 6.85939e-3, 1.31138e-2, 2.21431e-2, 3.46840e-2, 5.18252e-2, 7.53524e-2, 1.08818e-1, 1.32009e-1,
     1.72320e-1, 1.75111e-1, 1.78330e-1, 1.85582e-1, 2.03493e-1, 2.27831e-1, 2.64990e-1, 2.95736e-1, 3.20329e-1,
     3.94664e-1],
    [3.93780e-4, 1.09842e-3, 2.48453e-3, 5.10559e-3, 1.01023e-2, 2.00805e-2, 4.19563e-2, 9.93195e-2, 1.69529e-1,
     4.09658e-1, 4.12721e-1, 4.16333e-1, 4.24373e-1, 4.43443e-1, 4.67790e-1, 5.02409e-1, 5.29348e-1, 5.50003e-1,
     6.08065e-1],
    [5.40863e-4, 1.48908e-3, 3.31376e-3, 6.66944e-3, 1.28393e-2, 2.45722e-2, 4.85678e-2, 1.05127e-1, 1.67246e-1,
     3.52208e-1, 3.55104e-1, 3.58523e-1, 3.66147e-1, 3.84299e-1, 4.07614e-1, 4.41022e-1, 4.67219e-1, 4.87430e-1,
     5.44870e-1],
    [6.70209e-4, 1.82556e-3, 4.00960e-3, 7.93819e-3, 1.49606e-2, 2.78302e-2, 5.28556e-2, 1.07692e-1, 1.63795e-1,
     3.17141e-1, 3.19935e-1, 3.23234e-1, 3.30601e-1, 3.48196e-1, 3.70909e-1, 4.03649e-1, 4.29475e-1, 4.49488e-1,
     5.06827e-1],
    [7.86279e-4, 2.12233e-3, 4.61028e-3, 9.00377e-3, 1.66782e-2, 3.03334e-2, 5.58677e-2, 1.08862e-1, 1.60367e-1,
     2.92961e-1, 2.95687e-1, 2.98905e-1, 3.06098e-1, 3.23323e-1, 3.45649e-1, 3.77993e-1, 4.03628e-1, 4.23565e-1,
     4.81043e-1],
    [8.91901e-4, 2.38841e-3, 5.13912e-3, 9.92052e-3, 1.81117e-2, 3.23344e-2, 5.81024e-2, 1.09354e-1, 1.57234e-1,
     2.75066e-1, 2.77743e-1, 2.80902e-1, 2.87969e-1, 3.04936e-1, 3.27004e-1, 3.59111e-1, 3.84658e-1, 4.04584e-1,
     4.62331e-1],
    [1.07905e-3, 2.85127e-3, 6.03868e-3, 1.14371e-2, 2.03993e-2, 3.53704e-2, 6.12076e-2, 1.09442e-1, 1.51967e-1,
     2.50070e-1, 2.52685e-1, 2.55768e-1, 2.62673e-1, 2.79317e-1, 3.01095e-1, 3.33000e-1, 3.58546e-1, 3.78562e-1,
     4.37039e-1],
    [1.24187e-3, 3.24571e-3, 6.78654e-3, 1.26602e-2, 2.21738e-2, 3.76025e-2, 6.32836e-2, 1.09087e-1, 1.47842e-1,
     2.33292e-1, 2.35874e-1, 2.38912e-1, 2.45725e-1, 2.62199e-1, 2.83859e-1, 3.15765e-1, 3.41437e-1, 3.61622e-1,
     4.20947e-1],
    [1.38641e-3, 3.59006e-3, 7.42660e-3, 1.36823e-2, 2.36133e-2, 3.93428e-2, 6.47949e-2, 1.08634e-1, 1.44590e-1,
     2.21207e-1, 2.23770e-1, 2.26783e-1, 2.33544e-1, 2.49937e-1, 2.71576e-1, 3.03596e-1, 3.29461e-1, 3.49852e-1,
     4.10069e-1],
    [1.57727e-3, 4.03716e-3, 8.24164e-3, 1.49544e-2, 2.53566e-2, 4.13782e-2, 6.64682e-2, 1.08006e-1, 1.40900e-1,
     2.08332e-1, 2.10886e-1, 2.13881e-1, 2.20609e-1, 2.36978e-1, 2.58692e-1, 2.91001e-1, 3.17219e-1, 3.37955e-1,
     3.99524e-1],
    [1.84533e-3, 4.65240e-3, 9.33766e-3, 1.66211e-2, 2.75743e-2, 4.38821e-2, 6.84497e-2, 1.07300e-1, 1.36848e-1,
     1.94730e-1, 1.97293e-1, 2.00291e-1, 2.07033e-1, 2.23503e-1, 2.45490e-1, 2.78431e-1, 3.05314e-1, 3.26654e-1,
     3.90416e-1],
    [2.06950e-3, 5.15731e-3, 1.02189e-2, 1.79324e-2, 2.92805e-2, 4.57716e-2, 6.99515e-2, 1.07005e-1, 1.34420e-1,
     1.86416e-1, 1.89007e-1, 1.92027e-1, 1.98825e-1, 2.15484e-1, 2.37830e-1, 2.71480e-1, 2.99051e-1, 3.20992e-1,
     3.86821e-1],
    [2.26254e-3, 5.58636e-3, 1.09576e-2, 1.90169e-2, 3.06759e-2, 4.73121e-2, 7.12199e-2, 1.07024e-1, 1.32937e-1,
     1.81023e-1, 1.83649e-1, 1.86703e-1, 1.93578e-1, 2.10468e-1, 2.33207e-1, 2.67585e-1, 2.95836e-1, 3.18358e-1,
     3.86120e-1],
    [2.43225e-3, 5.95993e-3, 1.15948e-2, 1.99449e-2, 3.18646e-2, 4.86313e-2, 7.23567e-2, 1.07270e-1, 1.32200e-1,
     1.77419e-1, 1.80085e-1, 1.83177e-1, 1.90141e-1, 2.07279e-1, 2.30424e-1, 2.65525e-1, 2.94437e-1, 3.17514e-1,
     3.87082e-1],
    [2.58376e-3, 6.29112e-3, 1.21561e-2, 2.07586e-2, 3.29061e-2, 4.97985e-2, 7.34097e-2, 1.07679e-1, 1.31855e-1,
     1.74988e-1, 1.77695e-1, 1.80828e-1, 1.87887e-1, 2.05282e-1, 2.28831e-1, 2.64640e-1, 2.94189e-1, 3.17796e-1,
     3.89054e-1],
    [2.72068e-3, 6.58882e-3, 1.26585e-2, 2.14851e-2, 3.38378e-2, 5.08544e-2, 7.44036e-2, 1.08206e-1, 1.31820e-1,
     1.73365e-1, 1.76114e-1, 1.79290e-1, 1.86445e-1, 2.04099e-1, 2.28048e-1, 2.64543e-1, 2.94703e-1, 3.18815e-1,
     3.91658e-1], ])


def _Psi2C(psi, q):
    """
    converts my definition of potential Psi into Moch's definition of potential C
    :param psi: dimensionless potential Psi
    :param q: mass ratio
    :return: C
    """
    return 2 / (1 + q) * (q ** 2 / (2 * (1 + q)) - psi)


def _C2Psi(C, q):
    """
    converts Moch's definition of potential C into my definition of potential Psi
    :param C: Moch's potential C
    :param q: mass ratio
    :return: Psi
    """
    return 0.5 * (q ** 2 / (1 + q) - (1 + q) * C)


def _F2C(f, C1, C2):
    """
    Converts a filling factor F to Moch's potential C
    :param f: filling factor
    :param C1: value of C at L1
    :param C2: value of C at Lout
    :return: C
    """
    if f < 0:
        return 0
    elif f < 1:
        return C1 / f
    elif f <= 2:
        return C1 - (C1 - C2) * (f - 1)
    else:
        return 0


def _C(x, y, z, q):
    """
    computes Moch's potential C at given coordinates
    :param x: x coord
    :param y: y coord
    :param z: z coord
    :param q: mass ratio
    :return: C
    """
    return 2 / (1 + q) / cu.r(x, y, z) + 2 * q / (1 + q) / cu.rp(x, y, z) + (x - q / (1 + q)) ** 2 + y ** 2


def _F(C, C1, C2):
    """
    computes the filling factor F given a Moch's potential C
    :param C: moch's potential
    :param C1: value of C at L1
    :param C2: value of C at Lout
    :return: F
    """
    if C >= C1:
        return C1 / C
    elif C >= C2:
        return (C1 - C) / (C1 - C2) + 1
    else:
        return 0


def filling(psi, q):
    """
    computes the filling factor of a given potential Psi
    :param psi: dimensionless potential Psi
    :param q: mass ratio
    :return: F
    """
    if q > 1:
        out = lp.lfar(q)
    else:
        out = lp.lout(q)
    return _F(_Psi2C(psi, q), _C(lp.l1(q), 0, 0, q), _C(out, 0, 0, q))


def psi_from_F(f, q):
    """
    computes the corresponding potential Psi given a filling factor
    :param f: filling factor F
    :param q: mass ratio
    :return: Psi
    """
    if q > 1:
        out = lp.lfar(q)
    else:
        out = lp.lout(q)
    l1 = lp.l1(q)
    if np.array(f).size > 1:
        res = np.empty(len(f))
    else:
        return _C2Psi(_F2C(f, _C(l1, 0, 0, q), _C(out, 0, 0, q)), q)
    for i in range(len(f)):
        res[i] = _C2Psi(_F2C(f[i], _C(l1, 0, 0, q), _C(out, 0, 0, q)), q)
    return res


def _closest_q_moch(q):
    """
    selects the index in the qs array (defined above) that most closely matches a given q
    :param q: target mass ratio
    :return: index of qs
    """
    idx = 0
    closest = qs[0]
    for i in range(1, len(qs)):
        if abs(qs[i] - q) < abs(closest - q):
            idx = i
            closest = qs[i]
    return idx


def plot_moch_r_F(q):
    idx = _closest_q_moch(q)
    plt.plot(F[idx, :], rs[idx, :], label=r'$r_{{\rm equiv}}$(Filling), Mochnacki; $q = {}$'.format(qs[idx]))


def plot_moch_S_F(q):
    idx = _closest_q_moch(q)
    plt.plot(F[idx, :], areas[idx, :], label=r'$S_\Psi$(Filling), Mochnacki; $q = {}$'.format(qs[idx]))


def plot_moch_g_F(q):
    idx = _closest_q_moch(q)
    plt.plot(F[idx, :], gs[idx, :], label=r'$\langle g\rangle$(Filling), Mochnacki; $q = {}$'.format(qs[idx]))


def plot_moch_gminus1_F(q):
    idx = _closest_q_moch(q)
    plt.plot(F[idx, :], gminus1s[idx, :],
             label=r'$\langle g^{{-1}}\rangle$(Filling), Mochnacki; $q = {}$'.format(qs[idx]))
